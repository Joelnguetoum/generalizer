seq(
	loopS(
		seq(
			a -- query -> s,
			s -- price -> a,
			alt(
				seq(
					a -- split -> b,
					alt(
						seq(
							b -- no -> a,
							a -- no -> s
						),
						seq(
							b -- yes -> a,
							a -- buy -> s
						)
					)
				),
				seq(
					a -- cancel -> b,
					a -- no -> s
				)
			)
		)
	),
	a -- done -> s,
	a -- done -> b
)